library(dplyr)
library(readr)
library(stringr)
library(hflights)
library(tidyr)
library(lubridate)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
data <- read_csv("../data/spotify_songs.csv")
data <- data[c("track_id", "track_name", "track_artist", "track_popularity", "track_album_release_date", "playlist_genre", "duration_ms")]
data <- data %>%
rename(
TrackID = track_id,
TrackName = track_name,
Artist = track_artist,
Popularity = track_popularity,
ReleaseYear = track_album_release_date,
Genre = playlist_genre,
DurationMin = duration_ms
)
data$DurationMin <- data$DurationMin / 60000
data$DurationMin <- round(data$DurationMin, 2)
data$Artist <- as.factor(data$Artist)
data$Genre <- as.factor(data$Genre)
extractYear <- function(date) {
parsed_date <- ymd(date, quiet = TRUE)
if (any(!is.na(parsed_date))) {
return(year(parsed_date))
} else {
# Ako je datum u formatu samo godine (npr. "1999")
if (str_detect(date, "^\\d{4}$")) {
return(as.numeric(date))
} else {
return(NA) # Ako format nije prepoznat
}
}
}
data$ReleaseYear <- sapply(data$ReleaseYear, extractYear)
data <- data %>% filter(!is.na(ReleaseYear))
glimpse(data)
head(data)
ggplot(data, aes(x = Popularity)) +
geom_histogram(binwidth = 1, fill = "#00AFBB", color = "black") +
theme_minimal() +
labs(title = "Raspodjela Popularnosti Pjesama",
x = "Popularnost",
y = "Broj Pjesama",
caption = "Izvor podataka: Spotify") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
)
ggplot(data, aes(x = Popularity)) +
geom_histogram(binwidth = 1, fill = "#00AFBB", color = "black") +
theme_minimal() +
labs(title = "Raspodjela Popularnosti Pjesama",
x = "Popularnost",
y = "Broj Pjesama",
caption = "Izvor podataka: Spotify") +
theme(
#plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
)
ggplot(data, aes(x = Popularity)) +
geom_histogram(binwidth = 1, fill = "#00AFBB", color = "black") +
theme_minimal() +
labs(title = "Raspodjela Popularnosti Pjesama",
x = "Popularnost",
y = "Broj Pjesama",
caption = "Izvor podataka: Spotify") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10)
)
ggplot(data, aes(Genre)) + geom_bar()
ggplot(data, aes(Genre)) + geom_bar()
ggplot(data, aes(Genre)) + geom_bar(stat = 'identity')
ggplot(data, aes(Genre)) + geom_bar(fill = "#00AFBB")
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal()
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
#theme_minimal()
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal()
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB")
#theme_minimal()
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama")
ggplot(data, aes(Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(data, aes(x = Genre) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text("proba")
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(size = 12, face = "bold")
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold")
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold")
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 15, face = "bold"),
axis.title.y = element_text(size = 10, face = "bold"),
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
)
ggplot(data, aes(x = Genre)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama po Žanru", x = "Žanrovi", y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Filtriranje podataka samo za žanr "EDM" i godine izdanja
df_edm <- data[data$Genre == "EDM", ]
# Stvaranje bar grafa
ggplot(df_edm, aes(x = ReleaseYear)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama EDM Žanra po Godinama",
x = "Godina Izdanja",
y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Filtriranje podataka samo za žanr "EDM" i godine izdanja
df_edm <- data[data$Genre == "edm", ]
# Stvaranje bar grafa
ggplot(df_edm, aes(x = ReleaseYear)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama EDM Žanra po Godinama",
x = "Godina Izdanja",
y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Filtriranje podataka samo za žanr "EDM" i godine izdanja
df_edm <- data[data$Genre == "edm" & data$ReleaseYear >= 2000, ]
# Stvaranje bar grafa
ggplot(df_edm, aes(x = ReleaseYear)) +
geom_bar(fill = "#00AFBB") +
theme_minimal() +
labs(title = "Broj Pjesama EDM Žanra po Godinama",
x = "Godina Izdanja",
y = "Broj Pjesama") +
theme(
plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1)
)
